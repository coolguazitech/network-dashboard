# =============================================================================
# Scheduler Configuration — API 採集排程
# =============================================================================
#
# 每筆 entry = 一個 API call，scheduler 定期對所有目標設備執行。
#
# 命名規範（三處必須一致）：
#   1. 本檔的 key（如 get_fan）
#   2. .env 中 FETCHER_ENDPOINT__GET_FAN=...
#   3. Parser command: {key}_{device_type}_{source}
#      e.g. get_fan + hpe + dna → get_fan_hpe_dna
#
# source: 外部 API 來源
#   - FNA: FAB Network API（共用 endpoint，server 側自動偵測廠牌）
#   - DNA: Data Network API（每個 device_type 各自的 endpoint）
#
# interval: 觸發頻率（秒）。上一輪未完成時本次跳過（max_instances=1）
#
# =============================================================================

fetchers:
  # ---------------------------------------------------------------------------
  # FNA (5): 所有廠牌共用同一個 endpoint，只需 {ip}
  # ---------------------------------------------------------------------------
  get_gbic_details:
    source: FNA
    interval: 300
    description: "光模組 Tx/Rx 功率"

  get_channel_group:
    source: FNA
    interval: 300
    description: "Port-Channel 狀態及成員"

  get_error_count:
    source: FNA
    interval: 300
    description: "Interface 錯誤計數"

  get_static_acl:
    source: FNA
    interval: 300
    description: "Static ACL 綁定"

  get_dynamic_acl:
    source: FNA
    interval: 300
    description: "Dynamic ACL 綁定"

  # ---------------------------------------------------------------------------
  # DNA (7): 每個 device_type 各自的 endpoint
  # ---------------------------------------------------------------------------
  get_mac_table:
    source: DNA
    interval: 300
    description: "MAC 位址表"

  get_fan:
    source: DNA
    interval: 300
    description: "風扇狀態"

  get_power:
    source: DNA
    interval: 300
    description: "電源供應器狀態"

  get_version:
    source: DNA
    interval: 300
    description: "韌體版本"

  get_interface_status:
    source: DNA
    interval: 300
    description: "Interface 狀態（速率/雙工）"

  get_uplink_lldp:
    source: DNA
    interval: 300
    description: "Uplink 鄰居拓撲 (LLDP)"

  get_uplink_cdp:
    source: DNA
    interval: 300
    description: "Uplink 鄰居拓撲 (CDP，僅 Cisco IOS/NXOS)"

  # ---------------------------------------------------------------------------
  # GNMSPING: ICMP 連通性測試（統一批次 Ping）
  # 不走標準 ConfiguredFetcher，由 scheduler 按 tenant_group 分組 batch ping
  # base_url 設定在 GNMSPING__BASE_URLS__{TENANT} env vars
  # ---------------------------------------------------------------------------
  gnms_ping:
    source: GNMSPING
    interval: 30
    description: "Ping（設備 / Client IP 獨立排程，按 tenant_group 分組）"
